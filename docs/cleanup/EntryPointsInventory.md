# Entry Points Inventory (Dead Code Calibration)

Run:
- RUN_ID: 20251223-130514
- Evidence folder: docs/cleanup/_evidence/deadcode/20251223-130514/
- Purpose: calibrate knip/madge entry sets to avoid false positives in dead-code deletion.

Classification rules:
- LITERAL: string literal `'...'` / `"..."`.
- DETERMINISTIC_COMPUTED: built only from `__dirname` (or equivalent) + `path.join/resolve` + string literals (no variables, no conditionals, no templates, no env/JSON reads).
- DYNAMIC/UNKNOWN: anything else (variables, indirection, conditionals, templates, runtime data).

Tooling rule:
- LITERAL + DETERMINISTIC_COMPUTED are eligible to feed `knip.json entry[]` (record the resolution method).
- DYNAMIC/UNKNOWN is excluded from `entry[]` and must be closed by dynamic evidence (Phase 4) before any Class C changes.

Seed note (madge):
- Seed VERIFIED by evidence (CWD package.json):
  - `main = electron/main.js`
  - `scripts.start = electron .`
- Additional support: `electron/main.js` contains BrowserWindow creation and `loadFile` calls (entry surface).

---

## Source 1 — Main process windows (BrowserWindow + preload + loadFile)

### Window: mainWin
- Create evidence:
  - electron/main.js:L92 — `mainWin = new BrowserWindow({`
- Preload:
  - electron/main.js:L100 — `preload: path.join(__dirname, 'preload.js'),`
  - Class: DETERMINISTIC_COMPUTED
  - Resolution method: `path.join(__dirname,'preload.js')` -> repo-relative `electron/preload.js` (file presence is implied by preload surface; confirm with `git ls-files` if needed)
- HTML:
  - electron/main.js:L107 — `mainWin.loadFile(path.join(__dirname, '../public/index.html'));`
  - Class: DETERMINISTIC_COMPUTED
  - Resolution method: `path.join(__dirname,'../public/index.html')` -> `public/index.html`

### Window: editorWin
- Create evidence:
  - electron/main.js:L165 — `editorWin = new BrowserWindow({`
- Preload:
  - electron/main.js:L175 — `preload: path.join(__dirname, 'editor_preload.js'),`
  - Class: DETERMINISTIC_COMPUTED
  - Resolution: `electron/editor_preload.js`
- HTML:
  - electron/main.js:L184 — `editorWin.loadFile(path.join(__dirname, '../public/editor.html'));`
  - Class: DETERMINISTIC_COMPUTED
  - Resolution: `public/editor.html`

### Window: presetWin
- Create evidence:
  - electron/main.js:L242 — `presetWin = new BrowserWindow({`
- Preload:
  - electron/main.js:L252 — `preload: path.join(__dirname, 'preset_preload.js'),`
  - Class: DETERMINISTIC_COMPUTED
  - Resolution: `electron/preset_preload.js`
- HTML:
  - electron/main.js:L260 — `presetWin.loadFile(path.join(__dirname, '../public/preset_modal.html'));`
  - Class: DETERMINISTIC_COMPUTED
  - Resolution: `public/preset_modal.html`

### Window: langWin
- Create evidence:
  - electron/main.js:L327 — `langWin = new BrowserWindow({`
- Preload:
  - electron/main.js:L24 — `const LANGUAGE_PRELOAD = path.join(__dirname, 'language_preload.js');`
  - electron/main.js:L339 — `preload: LANGUAGE_PRELOAD,`
  - Class: DETERMINISTIC_COMPUTED
  - Resolution: `electron/language_preload.js`
- HTML:
  - electron/main.js:L23 — `const LANGUAGE_WINDOW_HTML = path.join(__dirname, '../public/language_window.html');`
  - electron/main.js:L347 — `langWin.loadFile(LANGUAGE_WINDOW_HTML);`
  - Class: DETERMINISTIC_COMPUTED
  - Resolution: `public/language_window.html`

### Window: flotanteWin
- Create evidence:
  - electron/main.js:L560 — `flotanteWin = new BrowserWindow(createOpts);`
  - electron/main.js:L558 — `const createOpts = Object.assign({}, bwOpts, pos, options);`
- Preload:
  - electron/main.js:L373 — `const FLOTANTE_PRELOAD = path.join(__dirname, 'flotante_preload.js');`
  - electron/main.js:L520 — `preload: FLOTANTE_PRELOAD,`
  - Class: DETERMINISTIC_COMPUTED
  - Resolution: `electron/flotante_preload.js`
- HTML:
  - electron/main.js:L375 — `const FLOTANTE_HTML = path.join(__dirname, '../public/flotante.html');`
  - electron/main.js:L584 — `await win.loadFile(FLOTANTE_HTML);`
  - Class: DETERMINISTIC_COMPUTED
  - Resolution: `public/flotante.html`

---

## Source 2 — Renderer HTML scripts (<script src> in order)

Evidence source: `entry.html.scripts.runtime.log` (generated by repo-wide `git ls-files -- '*.html'` + `Select-String`).

### HTML: public/index.html
- Evidence loaded (Source 1): electron/main.js:L107 -> `../public/index.html`
- Script order:
  1) public/index.html:L128 — src `./js/constants.js` -> resolved `public/js/constants.js` (normalize `public/./js/...`) ; class=LITERAL
  2) public/index.html:L129 — src `./js/notify.js` -> `public/js/notify.js` ; class=LITERAL
  3) public/index.html:L130 — src `./js/menu_actions.js` -> `public/js/menu_actions.js` ; class=LITERAL
  4) public/index.html:L131 — src `./js/i18n.js` -> `public/js/i18n.js` ; class=LITERAL
  5) public/index.html:L132 — src `./js/presets.js` -> `public/js/presets.js` ; class=LITERAL
  6) public/index.html:L133 — src `./js/count.js` -> `public/js/count.js` ; class=LITERAL
  7) public/index.html:L134 — src `./js/format.js` -> `public/js/format.js` ; class=LITERAL
  8) public/index.html:L135 — src `./js/crono.js` -> `public/js/crono.js` ; class=LITERAL
  9) public/index.html:L136 — src `renderer.js` -> `public/renderer.js` ; class=LITERAL

### HTML: public/editor.html
- Evidence loaded (Source 1): electron/main.js:L184 -> `../public/editor.html`
- Script order:
  1) public/editor.html:L25 — src `js/notify.js` -> `public/js/notify.js` ; class=LITERAL
  2) public/editor.html:L26 — src `js/i18n.js` -> `public/js/i18n.js` ; class=LITERAL
  3) public/editor.html:L27 — src `js/constants.js` -> `public/js/constants.js` ; class=LITERAL
  4) public/editor.html:L28 — src `editor.js` -> `public/editor.js` ; class=LITERAL

### HTML: public/preset_modal.html
- Evidence loaded (Source 1): electron/main.js:L260 -> `../public/preset_modal.html`
- Script order:
  1) public/preset_modal.html:L53 — src `js/notify.js` -> `public/js/notify.js` ; class=LITERAL
  2) public/preset_modal.html:L56 — src `js/i18n.js` -> `public/js/i18n.js` ; class=LITERAL
  3) public/preset_modal.html:L57 — src `js/constants.js` -> `public/js/constants.js` ; class=LITERAL
  4) public/preset_modal.html:L60 — src `preset_modal.js` -> `public/preset_modal.js` ; class=LITERAL

### HTML: public/flotante.html
- Evidence loaded (Source 1): electron/main.js:L584 -> `../public/flotante.html`
- Script order:
  1) public/flotante.html:L18 — src `js/i18n.js` -> `public/js/i18n.js` ; class=LITERAL
  2) public/flotante.html:L19 — src `js/crono.js` -> `public/js/crono.js` ; class=LITERAL
  3) public/flotante.html:L20 — src `flotante.js` -> `public/flotante.js` ; class=LITERAL

### HTML: public/language_window.html
- Evidence loaded (Source 1): electron/main.js:L347 -> `../public/language_window.html`
- Scripts: none (`<script src>` not found)

### HTML present in repo (tracked) but not statically referenced by Source 1
- public/info/acerca_de.html — scripts: none
- public/info/instrucciones.html — scripts: none
- public/info/readme.html — scripts: none

These are not declared entry points yet; treat them as potential hidden entry surfaces until closure evidence is collected (see Unknowns/Risks).

---

## Derived JS entry set (unique, normalized)

Main process:
- electron/main.js

Preloads:
- electron/preload.js
- electron/editor_preload.js
- electron/preset_preload.js
- electron/language_preload.js
- electron/flotante_preload.js

Renderer top-level (from HTML script tags):
- public/renderer.js
- public/editor.js
- public/preset_modal.js
- public/flotante.js

Shared renderer libs (from HTML script tags):
- public/js/constants.js
- public/js/notify.js
- public/js/menu_actions.js
- public/js/i18n.js
- public/js/presets.js
- public/js/count.js
- public/js/format.js
- public/js/crono.js

---

## Unknowns / Risks (single list)

### R1 — “Tracked HTML not referenced by main process”
- Items:
  - public/info/acerca_de.html
  - public/info/instrucciones.html
  - public/info/readme.html
- Risk:
  - Could be loaded by renderer navigation (links/buttons) or by loadURL elsewhere; if so, treating them as non-entry could produce knip false positives in related assets/scripts and cause later Class B/C mistakes.
- Closure plan:
  - Phase 2 (static): repo-wide search for references to these filenames and/or `public/info/`.
  - If no static references: Phase 4 (dynamic): log/trace local HTML navigations (loadURL/loadFile and renderer navigation) to confirm non-use.

### R2 — “defaults_presets*.js flagged unused by knip but loaded dynamically”
- Items (knip reported as unused files):
  - electron/presets/defaults_presets.js
  - electron/presets/defaults_presets_en.js
  - electron/presets/defaults_presets_es.js
- Static evidence of dynamic loading (paths/templates/regex; therefore knip can miss it):
  - electron/presets_main.js:L43 — `loadPresetArrayFromJs(path.join(presetsDir, 'defaults_presets.js'))...`
  - electron/presets_main.js:L46 — `const langFile = path.join(presetsDir, \`defaults_presets_${langCode}.js\`);`
  - electron/presets_main.js:L65 — `.filter((name) => /^defaults_presets.*\.js$/i.test(name))`
- Risk:
  - Treating these as dead files would break default preset loading and/or preset bootstrapping, and would contaminate later Class B decisions based on static “unused file” signals.
- Closure plan:
  - Phase 2 (static): keep as DYNAMIC/UNKNOWN candidates (do not delete); require a second static check for any alternative sources (JSON variants) before deciding.
  - Phase 4 (dynamic): instrument the preset loader (`loadPresetArrayFromJs` and any directory scan) to log which defaults files are actually loaded at runtime (include langCode), then decide:
    - If never loaded across smoke test paths -> candidate B with strong dynamic evidence.
    - If loaded -> not dead; optionally refactor loader to a static map if you want knip/madge to see it.
